# 그림 개체 효과 속성 요약 (Picture Effects)

> 원문 참조: 표 108(그림 효과 속성), 표 109(그림자), 표 110(네온), 표 111(부드러운 가장자리), 표 112(반사)

## 개요

`HWPTAG_SHAPE_COMPONENT_PICTURE`(HWPTAG_BEGIN+69) 레코드 내부에는 선택적인 그림 효과 속성이 포함됩니다. 이는 별도의 Tag ID가 아닌, 그림 개체의 하위 속성입니다.

## 효과 목록(발췌)

- 그림자(Shadow)
- 네온(Glow)
- 부드러운 가장자리(Soft Edge)
- 반사(Reflect)
- 색상 효과(Color Effects)

## 구조 개요

- 효과 존재 비트플래그: `그림 효과 정보`(UINT32)
- 효과별 속성 블록: 존재 플래그가 켜진 항목만 이어서 직렬화

## 속성 예시

- 그림자(표 109): 오프셋, 방향, 투명도 등
- 네온(표 110): 반경, 투명도 등
- 부드러운 가장자리(표 111): 반경
- 반사(표 112): 오프셋, 투명도, 블러 등

---

자세한 필드와 타입은 원문 표 108~112를 참조하세요.

## 관련 표 (원문)

- 표 108: 그림 효과 속성
- 표 109: 그림자 효과 속성
- 표 110: 네온 효과 속성
- 표 111: 부드러운 가장자리 효과 속성
- 표 112: 반사 효과 속성

## 상세 구조 (원문 표 요약)

### 표 108: 그림 효과 속성 (EffectsHeader)

| 항목             | 자료형     | 길이 | 설명                                                          |
| ---------------- | ---------- | ---- | ------------------------------------------------------------- |
| 그림 효과 플래그 | UINT32     | 4    | 각 효과 존재 여부 비트 플래그(그림자/네온/부드러운/반사)      |
| 효과별 속성 블록 | BYTESTREAM | n    | 존재 플래그가 켜진 효과의 속성 블록이 순차 직렬화(표 109~114) |
| 전체 길이        | -          | 가변 | 4 + n 바이트                                                  |

> 주: 플래그의 비트 배치는 원문에 구체 비트 인덱스가 명시되지 않았습니다. “존재 여부 플래그”임을 확실히 하고, 실제 비트 위치 매핑은 구현 시 원문 구조와 샘플 문서로 확인하세요.

### 효과 존재 플래그(개요)

| 효과              | 비트 | 의미              |
| ----------------- | ---- | ----------------- |
| 그림자(Shadow)    | -    | 존재 여부(표 109) |
| 네온(Glow)        | -    | 존재 여부(표 110) |
| 부드러운 가장자리 | -    | 존재 여부(표 111) |
| 반사(Reflect)     | -    | 존재 여부(표 112) |

### 표 109: 그림자 효과 속성

| 자료형     | 길이 | 설명                     |
| ---------- | ---- | ------------------------ |
| INT32      | 4    | 그림자 스타일            |
| float      | 4    | 그림자 투명도            |
| float      | 4    | 그림자 흐릿하게          |
| float      | 4    | 방향                     |
| float      | 4    | 거리                     |
| INT32      | 4    | 정렬                     |
| float      | 4    | 기울기 각도(X)           |
| float      | 4    | 기울기 각도(Y)           |
| float      | 4    | 확대 비율(X)             |
| float      | 4    | 확대 비율(Y)             |
| INT32      | 4    | 도형과 함께 그림자 회전  |
| BYTESTREAM | n    | 그림자 색상(표 113 참조) |
| 전체 길이  | 가변 | 44 + n 바이트            |

### 표 110: 네온 효과 속성

| 자료형     | 길이 | 설명                   |
| ---------- | ---- | ---------------------- |
| float      | 4    | 네온 투명도            |
| float      | 4    | 네온 반경              |
| BYTESTREAM | n    | 네온 색상(표 113 참조) |
| 전체 길이  | 가변 | 8 + n 바이트           |

### 표 111: 부드러운 가장자리 효과 속성

| 자료형    | 길이 | 설명                   |
| --------- | ---- | ---------------------- |
| float     | 4    | 부드러운 가장자리 반경 |
| 전체 길이 | 4    | -                      |

### 표 112: 반사 효과 속성

| 자료형    | 길이 | 설명           |
| --------- | ---- | -------------- |
| INT32     | 4    | 반사 스타일    |
| float     | 4    | 반경           |
| float     | 4    | 방향           |
| float     | 4    | 거리           |
| float     | 4    | 기울기 각도(X) |
| float     | 4    | 기울기 각도(Y) |
| float     | 4    | 확대 비율(X)   |
| float     | 4    | 확대 비율(Y)   |
| INT32     | 4    | 회전 스타일    |
| float     | 4    | 시작 투명도    |
| float     | 4    | 시작 위치      |
| float     | 4    | 끝 투명도      |
| float     | 4    | 끝 위치        |
| float     | 4    | 오프셋 방향    |
| 전체 길이 | 53   | -              |

### 표 113: 색상 속성(Color)

| 자료형        | 길이 | 설명                   |
| ------------- | ---- | ---------------------- |
| INT32         | 4    | 색상 타입              |
| UINT32        | 4    | RGB (0x00rrggbb)       |
| UINT32        | 4    | CMYK (0xccmmyykk)      |
| INT32         | 4    | 스키마 타입            |
| INT32         | 4    | 시스템 타입            |
| INT32         | 4    | 프리셋 타입            |
| float         | 4    | ScR                    |
| float         | 4    | ScG                    |
| float         | 4    | ScB                    |
| float         | 4    | H                      |
| float         | 4    | S                      |
| float         | 4    | L                      |
| UINT32        | 4    | 색상 효과 수           |
| BYTE array[n] | 8×n  | 색상 효과(표 114 참조) |
| 전체 길이     | 가변 | 4 + m(4~12) + n 바이트 |

### 표 114: 색상 효과 속성(ColorEffect)

| 자료형    | 길이 | 의미                   |
| --------- | ---- | ---------------------- |
| INT32     | 4    | 색상 효과 종류(표 115) |
| float     | 4    | 색상 효과 값           |
| 전체 길이 | 8    | -                      |

> 표 115(색상 효과 종류)는 원문을 참조하세요.
