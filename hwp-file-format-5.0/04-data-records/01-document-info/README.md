# 문서 정보 레코드 (DocInfo)

## 개요

문서 전역에 대한 메타데이터와 참조 테이블이 저장되는 스트림입니다. 본문(BodyText)과 개체에서 다양한 ID로 참조됩니다.

## 포함 레코드 목록

| Tag ID                        | 이름            | 용도                                          |
| ----------------------------- | --------------- | --------------------------------------------- |
| `HWPTAG_DOCUMENT_PROPERTIES`  | 문서 속성       | 문서 전역 속성(파일 버전, 옵션 등)            |
| `HWPTAG_ID_MAPPINGS`          | ID 매핑         | 각종 리소스 ID 매핑 테이블                    |
| `HWPTAG_BIN_DATA`             | 바이너리 데이터 | BinData 항목의 메타 정보(유형, 압축, 참조 등) |
| `HWPTAG_FACE_NAME`            | 글꼴            | 글꼴 패밀리/대체 글꼴 정보                    |
| `HWPTAG_BORDER_FILL`          | 테두리/배경     | 테두리/배경 정의 (선/면 채움/이미지 배경)     |
| `HWPTAG_CHAR_SHAPE`           | 글자 모양       | 문자 서식(폰트, 크기, 간격, 색상 등)          |
| `HWPTAG_TAB_DEF`              | 탭 정의         | 탭 위치/정렬/채움 문자 세트                   |
| `HWPTAG_NUMBERING`            | 번호 매기기     | 문단 번호 매기기 규칙                         |
| `HWPTAG_BULLET`               | 글머리표        | 글머리표(문자/그림) 규칙                      |
| `HWPTAG_PARA_SHAPE`           | 문단 모양       | 정렬, 들여쓰기, 간격, 테두리 등 문단 서식     |
| `HWPTAG_STYLE`                | 스타일          | 스타일 이름과 기반 서식 참조                  |
| `HWPTAG_DOC_DATA`             | 문서 데이터     | 문서 속 데이터(요약/사용자 정의 등)           |
| `HWPTAG_DISTRIBUTE_DOC_DATA`  | 배포용 데이터   | 배포 문서 관련 옵션/메타                      |
| `HWPTAG_COMPATIBLE_DOCUMENT`  | 호환 문서       | 호환성 옵션                                   |
| `HWPTAG_LAYOUT_COMPATIBILITY` | 레이아웃 호환성 | 조판 호환 옵션                                |

> 범례/출처: Tag ID/값 표기는 `05-appendix/tag-id-reference.md`를 참고하세요.

---

## HWPTAG_DOCUMENT_PROPERTIES (문서 속성)

문서 전역 옵션과 버전, 암호/압축 등 최상위 메타데이터를 정의합니다.

- 파일 버전: `0xMMnnPPrr` (개요의 버전 체계를 따름)
- 압축/암호화 플래그
- 기본 언어, 페이지/단위 기본값 등

## HWPTAG_ID_MAPPINGS (ID 매핑)

본문/개체에서 사용하는 다양한 리소스(폰트, 스타일, 테두리/배경 등)의 ID 매핑 테이블입니다.

- 항목 수와 각 항목의 종류/ID 범위
- 본문에서 참조되는 정수 ID ↔ DocInfo 테이블 인덱스

## HWPTAG_BIN_DATA (바이너리 데이터)

`BinData/` 스토리지의 항목에 대한 메타입니다.

- 항목 타입(그림, OLE, 미디어 등)
- 압축/원본 크기
- 참조 카운트

## HWPTAG_FACE_NAME (글꼴)

글꼴 패밀리, 대체 글꼴, 스크립트(한글/라틴/심벌 등)별 매핑을 정의합니다.

- 패밀리명(한글/영문)
- 대체/링크 폰트
- 스크립트별 폰트 우선순위

## HWPTAG_BORDER_FILL (테두리/배경)

문단/쪽/개체에 적용 가능한 테두리 선/배경(단색/그라디언트/이미지)을 정의합니다.

- 선(종류, 굵기, 색)
- 면 채움(단색/그라디언트/패턴)
- 배경 이미지(소스, 크기/반복/정렬)

## HWPTAG_CHAR_SHAPE (글자 모양)

문자 서식 러닝(run)을 구성하는 기본 단위입니다.

- 글꼴(스크립트별), 크기, 장평/자간
- 베이스라인, 음영/윤곽, 색상(RGB)
- 밑줄/취소선/위·아래 첨자

## HWPTAG_TAB_DEF (탭 정의)

- 탭 스톱 목록(위치, 정렬: 좌/중/우/소수점)
- 채움 문자(점/선 등)

## HWPTAG_NUMBERING (번호 매기기)

- 레벨별 서식(숫자/로마자/한글/알파벳)
- 접두/접미 문자열, 자릿수, 시작값

## HWPTAG_BULLET (글머리표)

- 문자/그림 글머리표
- 들여쓰기, 기호 정렬/간격

## HWPTAG_PARA_SHAPE (문단 모양)

- 정렬(좌/중/우/양쪽)
- 들여쓰기/내어쓰기/단락 간격
- 줄 간격(고정/최소/배수)
- 테두리/배경 참조

## HWPTAG_STYLE (스타일)

- 스타일 이름/설명
- 기반 스타일, 연결된 문단/글자 모양 ID

## HWPTAG_DOC_DATA (문서 데이터)

- 문서 요약/속성 확장
- 사용자 정의 키/값

## HWPTAG_DISTRIBUTE_DOC_DATA (배포용 데이터)

- 배포 옵션(읽기전용, 인쇄/복사 제한 등)

## HWPTAG_COMPATIBLE_DOCUMENT / LAYOUT_COMPATIBILITY

- 버전 호환성 스위치(조판 차이 최소화)
- 레이아웃 엔진 옵션(줄나눔/자간 등)

---

### 파싱 팁

- DocInfo는 본문보다 먼저 읽어 ID 테이블을 준비해야 합니다.
- 본문에서 나오는 각종 ID는 DocInfo 테이블 인덱스를 참조합니다.
- 알 수 없는 항목은 보존하면서 건너뛰어 하위 호환성을 유지하세요.

## 관련 표 (원문)

- 표 13: 문서 정보의 데이터 레코드(태그 목록)
- 테두리/배경: 표 23~31
- 글자 모양: 표 33~35
- 탭 정의: 표 36~37
- 문단 번호/머리 정보/번호 형식: 표 38~41
- 글머리표: 표 42
- 문단 모양/줄 간격: 표 43~46
- 스타일/스타일 종류: 표 47~48
- 문서 임의의 데이터/파라미터: 표 49~52
- 배포용 문서 데이터: 표 53
- 호환 문서/대상 프로그램: 표 54~55
- 레이아웃 호환성: 표 56
