# 개요

## 한글 문서 파일의 기본 특성

한글의 문서 파일은 사용자가 따로 지정하지 않는 한 **`.hwp`**를 기본 확장자로 가집니다.

### 저장 내용

문서 파일에 저장되는 내용은 다음과 같습니다:

- **문서 내용**: 실제 사용자가 입력한 문서의 텍스트
- **문자 장식 정보**: 글꼴, 크기, 색상, 스타일 등의 서식 정보
- **편집 환경 정보**: 문서를 편집할 당시의 한글에 대한 정보
- **조판 설정**: 용지 종류, 여백 정보 등 레이아웃에 영향을 주는 설정

## 적용 제품 및 버전

**한글 문서 파일 형식 5.0**은 **2000년 10월 이후**에 출시된 한글 제품군에서 생성됩니다:

- **한글 워디안** (2000년 10월~)
- **한글 2002**
- **한글 2005**
- **한글 2007**
- **한글 2010**
- **한글 2014**
- **한글 2018**

### 버전별 차이점

문서 버전에 따라 **큰 골격은 유지**되나, **추가적인 정보들에 의해 약간의 차이**가 있습니다.

## 파일 구조의 기술적 특징

### 1. 압축 기능

한글 문서 파일 형식 5.0은 **파일의 크기를 최소화**하기 위하여 압축 기능을 이용합니다.

#### 압축 범위

- **압축되지 않는 부분**: 기본적인 정보를 저장하는 부분
- **압축되는 부분**: 사용자가 입력한 본문과 그림 관련 데이터

#### 압축 라이브러리

- **사용 라이브러리**: [zlib.org](http://zlib.org)의 **zlib**
- **라이센스**: zlib License
- **특징**:
  - 웹상에 소스가 공개되어 있는 공개 소프트웨어
  - 소스의 자유로운 사용 가능
  - 2차 산출물에 대한 소스 공개 의무 없음

### 2. 복합 파일 구조

한글 문서 파일 형식 5.0의 구조는 **윈도우즈의 복합 파일(Compound File)**에 기초를 둡니다.

#### 접근 방법

**참고 자료**: OLE관련 자료 또는 MSDN 참조

- `StgOpenStorage()`
- `IStorage::Open()`
- 기타 Structured Storage API

### 3. 문자 코드 체계

**ISO-10646 표준**을 기반으로 합니다.

#### 문자 정보 저장

- **대부분의 문자 정보**: **유니코드(UTF-16LE)** 형식으로 전달되고 저장
- **특징**: 한글, 영문, 한자를 비롯해 모든 문자가 2바이트의 일정한 길이

## 파일 버전 체계

### 버전 형식

파일 버전은 **`0xMMnnPPrr`** 형태로 표현됩니다:

| 구분   | 의미                                                                 | 호환성                                  |
| ------ | -------------------------------------------------------------------- | --------------------------------------- |
| **MM** | 문서 형식의 구조가 완전히 바뀜                                       | 숫자가 다르면 구 버전과 **호환 불가능** |
| **nn** | 큰 구조는 동일하나 큰 변화                                           | 숫자가 다르면 구 버전과 **호환 불가능** |
| **PP** | 구조는 동일, Record 추가되거나 하위 버전에서 호환되지 않는 정보 추가 | 숫자가 달라도 구 버전과 **호환 가능**   |
| **rr** | Record에 정보들이 추가됨                                             | 숫자가 달라도 구 버전과 **호환 가능**   |

### 예시

- **5.0.3.0**: 한글 2018의 문서 버전

## 개발자를 위한 핵심 정보

### 필수 이해 사항

1. **복합 파일 구조**: Windows OLE Compound Storage 이해 필요
2. **레코드 기반 파싱**: Tag ID와 Level을 이용한 계층적 데이터 처리
3. **압축 처리**: zlib을 이용한 압축 해제
4. **유니코드 처리**: UTF-16LE 문자열 처리
5. **하위 호환성**: 미지 레코드는 크기만큼 건너뛰어 처리

### 개발 시 고려사항

- **성능**: 큰 파일의 경우 스트리밍 처리 고려
- **메모리**: 전체 파일을 메모리에 로드하지 않고 필요한 부분만 읽기
- **오류 처리**: 손상된 파일이나 알 수 없는 버전에 대한 처리
- **확장성**: 새로운 레코드 타입이 추가될 가능성을 고려한 설계

---

_한글 문서 파일 형식 5.0은 한국의 대표적인 워드프로세서인 한글의 핵심 파일 형식으로, 수많은 문서가 이 형식으로 저장되어 있습니다._

## 관련 표 (원문)

- 해당 섹션에 표 없음
