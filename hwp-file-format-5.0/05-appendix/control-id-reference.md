# 컨트롤 ID 참조표

> 출처: 원문 표 127(개체 이외의 컨트롤과 컨트롤 ID), 표 128(필드 컨트롤 ID), 표 64(컨트롤 헤더), 표 65(문단 리스트 헤더)

## 개요

한글 문서에서 사용되는 모든 컨트롤 ID들의 완전한 참조표입니다. 컨트롤 ID는 문서 내의 각종 개체와 기능을 식별하는 고유한 식별자입니다.

## 개체 이외의 컨트롤

### 문서 구조 컨트롤

| 컨트롤 ID                       | ASCII  | 설명      | 문단 리스트 | 파일 태그                 | 출처   |
| ------------------------------- | ------ | --------- | ----------- | ------------------------- | ------ |
| **MAKE_4CHID('s','e','c','d')** | 'secd' | 구역 정의 | ✅          | HWPTAG_CTRL_HEADER로 시작 | 표 127 |
| **MAKE_4CHID('c','o','l','d')** | 'cold' | 단 정의   | ❌          | 해당 없음                 | 표 127 |
| **MAKE_4CHID('h','e','a','d')** | 'head' | 머리말    | ✅          | 해당 없음                 | 표 127 |
| **MAKE_4CHID('f','o','o','t')** | 'foot' | 꼬리말    | ✅          | 해당 없음                 | 표 127 |

> 범례: "문단 리스트" 열은 해당 컨트롤이 독자적인 문단 리스트를 포함하는지 여부를 나타냅니다(원문 표 65 참조). "파일 태그" 열의 공란은 해당 없음/미적용을 의미합니다.

### 주석 컨트롤

| 컨트롤 ID                       | ASCII | 설명 | 문단 리스트 | 파일 태그 | 출처   |
| ------------------------------- | ----- | ---- | ----------- | --------- | ------ |
| **MAKE_4CHID('f','n',' ',' ')** | 'fn ' | 각주 | ✅          | 해당 없음 | 표 127 |
| **MAKE_4CHID('e','n',' ',' ')** | 'en ' | 미주 | ✅          | 해당 없음 | 표 127 |

### 번호 매기기 컨트롤

| 컨트롤 ID                       | ASCII  | 설명         | 문단 리스트 | 파일 태그 | 출처   |
| ------------------------------- | ------ | ------------ | ----------- | --------- | ------ |
| **MAKE_4CHID('a','t','n','o')** | 'atno' | 자동번호     | ❌          | 해당 없음 | 표 127 |
| **MAKE_4CHID('n','w','n','o')** | 'nwno' | 새 번호 지정 | ❌          | 해당 없음 | 표 127 |

### 페이지 제어 컨트롤

| 컨트롤 ID                       | ASCII  | 설명         | 문단 리스트 | 파일 태그 | 출처   |
| ------------------------------- | ------ | ------------ | ----------- | --------- | ------ |
| **MAKE_4CHID('p','g','h','d')** | 'pghd' | 감추기       | ❌          | 해당 없음 | 표 127 |
| **MAKE_4CHID('p','g','c','t')** | 'pgct' | 홀/짝수 조정 | ❌          | 해당 없음 | 표 127 |
| **MAKE_4CHID('p','g','n','p')** | 'pgnp' | 쪽 번호 위치 | ❌          | 해당 없음 | 표 127 |

### 참조 컨트롤

| 컨트롤 ID                       | ASCII  | 설명          | 문단 리스트 | 파일 태그 | 출처   |
| ------------------------------- | ------ | ------------- | ----------- | --------- | ------ |
| **MAKE_4CHID('i','d','x','m')** | 'idxm' | 찾아보기 표식 | ❌          | 해당 없음 | 표 127 |
| **MAKE_4CHID('b','o','k','m')** | 'bokm' | 책갈피        | ❌          | 해당 없음 | 표 127 |

### 텍스트 효과 컨트롤

| 컨트롤 ID                       | ASCII  | 설명      | 문단 리스트 | 파일 태그 | 출처   |
| ------------------------------- | ------ | --------- | ----------- | --------- | ------ |
| **MAKE_4CHID('t','c','p','s')** | 'tcps' | 글자 겹침 | ❌          |           | 표 127 |
| **MAKE_4CHID('t','d','u','t')** | 'tdut' | 덧말      | ❌          |           | 표 127 |
| **MAKE_4CHID('t','c','m','t')** | 'tcmt' | 숨은 설명 | ✅          |           | 표 127 |

## 필드 컨트롤 ID

### 기본 필드

| 컨트롤 ID                       | ASCII  | 설명            | 출처   |
| ------------------------------- | ------ | --------------- | ------ |
| **MAKE_4CHID('%','u','n','k')** | '%unk' | 알 수 없는 필드 | 표 128 |
| **MAKE_4CHID('%','d','t','e')** | '%dte' | 날짜            | 표 128 |
| **MAKE_4CHID('%','d','d','t')** | '%ddt' | 문서 날짜       | 표 128 |
| **MAKE_4CHID('%','p','a','t')** | '%pat' | 경로            | 표 128 |
| **MAKE_4CHID('%','b','m','k')** | '%bmk' | 책갈피          | 표 128 |
| **MAKE_4CHID('%','m','m','g')** | '%mmg' | 편지 병합       | 표 128 |
| **MAKE_4CHID('%','x','r','f')** | '%xrf' | 상호 참조       | 표 128 |
| **MAKE_4CHID('%','f','m','u')** | '%fmu' | 수식            | 표 128 |
| **MAKE_4CHID('%','c','l','k')** | '%clk' | 누름틀          | 표 128 |
| **MAKE_4CHID('%','s','m','r')** | '%smr' | 요약            | 표 128 |
| **MAKE_4CHID('%','u','s','r')** | '%usr' | 사용자 정보     | 표 128 |
| **MAKE_4CHID('%','h','l','k')** | '%hlk' | 하이퍼링크      | 표 128 |

### 변경 내용 추적 필드

| 컨트롤 ID                        | ASCII   | 설명                 | 출처   |
| -------------------------------- | ------- | -------------------- | ------ |
| **MAKE_4CHID('%','s','i','g')**  | '%sig'  | 변경 내용 서명       | 표 128 |
| **MAKE_4CHID('%','%','\*','d')** | '%%\*d' | 변경 내용 삭제       | 표 128 |
| **MAKE_4CHID('%','%','\*','a')** | '%%\*a' | 변경 내용 첨부       | 표 128 |
| **MAKE_4CHID('%','%','\*','C')** | '%%\*C' | 변경 내용 자르기     | 표 128 |
| **MAKE_4CHID('%','%','\*','S')** | '%%\*S' | 변경 내용 톱니       | 표 128 |
| **MAKE_4CHID('%','%','\*','T')** | '%%\*T' | 변경 내용 생각       | 표 128 |
| **MAKE_4CHID('%','%','\*','P')** | '%%\*P' | 변경 내용 칭찬       | 표 128 |
| **MAKE_4CHID('%','%','\*','L')** | '%%\*L' | 변경 내용 줄         | 표 128 |
| **MAKE_4CHID('%','%','\*','c')** | '%%\*c' | 변경 내용 간단 변경  | 표 128 |
| **MAKE_4CHID('%','%','\*','h')** | '%%\*h' | 변경 내용 하이퍼링크 | 표 128 |

### 변경 내용 추적 확장 필드

| 컨트롤 ID                        | ASCII   | 설명                  | 출처   |
| -------------------------------- | ------- | --------------------- | ------ |
| **MAKE_4CHID('%','%','\*','A')** | '%%\*A' | 변경 내용 줄 첨부     | 표 128 |
| **MAKE_4CHID('%','%','\*','i')** | '%%\*i' | 변경 내용 줄 링크     | 표 128 |
| **MAKE_4CHID('%','%','\*','t')** | '%%\*t' | 변경 내용 줄 이동     | 표 128 |
| **MAKE_4CHID('%','%','\*','r')** | '%%\*r' | 변경 내용 오른쪽 이동 | 표 128 |
| **MAKE_4CHID('%','%','\*','l')** | '%%\*l' | 변경 내용 왼쪽 이동   | 표 128 |
| **MAKE_4CHID('%','%','\*','n')** | '%%\*n' | 변경 내용 이동        | 표 128 |
| **MAKE_4CHID('%','%','\*','e')** | '%%\*e' | 변경 내용 간단 삽입   | 표 128 |

### 기타 특수 필드

| 컨트롤 ID                       | ASCII  | 설명           | 출처   |
| ------------------------------- | ------ | -------------- | ------ |
| **MAKE_4CHID('%','s','p','l')** | '%spl' | 변경 내용 분할 | 표 128 |
| **MAKE_4CHID('%','%','m','r')** | '%%mr' | 변경 내용 변경 | 표 128 |
| **MAKE_4CHID('%','%','m','e')** | '%%me' | 메모           | 표 128 |
| **MAKE_4CHID('%','c','p','r')** | '%cpr' | 개인정보보안   | 표 128 |
| **MAKE_4CHID('%','t','o','c')** | '%toc' | 목차           | 표 128 |

## 개체 컨트롤 ID

### 기본 개체

| 컨트롤 ID                       | ASCII  | 설명      | 출처  |
| ------------------------------- | ------ | --------- | ----- |
| **MAKE_4CHID('$','o','l','e')** | '$ole' | OLE 개체  | 표 67 |
| **MAKE_4CHID('$','p','i','c')** | '$pic' | 그림 개체 | 표 67 |
| **MAKE_4CHID('$','t','b','l')** | '$tbl' | 표 개체   | 표 67 |
| **MAKE_4CHID('$','e','q','u')** | '$equ' | 수식 개체 | 표 67 |

### 그리기 개체

| 컨트롤 ID                       | ASCII  | 설명        | 출처  |
| ------------------------------- | ------ | ----------- | ----- |
| **MAKE_4CHID('$','l','i','n')** | '$lin' | 선 개체     | 표 67 |
| **MAKE_4CHID('$','r','e','c')** | '$rec' | 사각형 개체 | 표 67 |
| **MAKE_4CHID('$','e','l','l')** | '$ell' | 타원 개체   | 표 67 |
| **MAKE_4CHID('$','a','r','c')** | '$arc' | 호 개체     | 표 67 |
| **MAKE_4CHID('$','p','o','l')** | '$pol' | 다각형 개체 | 표 67 |
| **MAKE_4CHID('$','c','u','r')** | '$cur' | 곡선 개체   | 표 67 |

### 특수 개체

| 컨트롤 ID                       | ASCII  | 설명        | 출처  |
| ------------------------------- | ------ | ----------- | ----- |
| **MAKE_4CHID('$','c','o','n')** | '$con' | 묶음 개체   | 표 67 |
| **MAKE_4CHID('$','t','x','t')** | '$txt' | 글맵시 개체 | 표 67 |
| **MAKE_4CHID('$','v','i','d')** | '$vid' | 동영상 개체 | 표 67 |

> 비고: `$vid` 컨트롤은 본문/개체 데이터에서 `HWPTAG_VIDEO_DATA`(HWPTAG_BEGIN+82) 레코드와 연계되어 저장됩니다.

## 프로그래밍 예시

### 컨트롤 ID 생성 매크로

```c
// 4글자 문자열을 컨트롤 ID로 변환
#define MAKE_4CHID(a,b,c,d) \
    (((DWORD)(BYTE)(a)) | \
     ((DWORD)(BYTE)(b) << 8) | \
     ((DWORD)(BYTE)(c) << 16) | \
     ((DWORD)(BYTE)(d) << 24))
```

### 컨트롤 ID 판별 함수

```c
bool is_field_control(UINT32 ctrl_id) {
    char ch = (char)(ctrl_id & 0xFF);
    return (ch == '%');
}

bool is_object_control(UINT32 ctrl_id) {
    char ch = (char)(ctrl_id & 0xFF);
    return (ch == '$');
}

bool is_structure_control(UINT32 ctrl_id) {
    return !is_field_control(ctrl_id) && !is_object_control(ctrl_id);
}
```

### 컨트롤 ID 출력 함수

```c
void print_control_id(UINT32 ctrl_id) {
    char ch[5];
    ch[0] = (char)(ctrl_id & 0xFF);
    ch[1] = (char)((ctrl_id >> 8) & 0xFF);
    ch[2] = (char)((ctrl_id >> 16) & 0xFF);
    ch[3] = (char)((ctrl_id >> 24) & 0xFF);
    ch[4] = '\0';
    printf("Control ID: 0x%08X ('%s')\n", ctrl_id, ch);
}
```

### 컨트롤 타입 분류

```c
typedef enum {
    CTRL_TYPE_UNKNOWN = 0,
    CTRL_TYPE_STRUCTURE,    // 문서 구조
    CTRL_TYPE_FIELD,        // 필드
    CTRL_TYPE_OBJECT        // 개체
} CTRL_TYPE;

CTRL_TYPE get_control_type(UINT32 ctrl_id) {
    char first_ch = (char)(ctrl_id & 0xFF);

    if (first_ch == '%') {
        return CTRL_TYPE_FIELD;
    } else if (first_ch == '$') {
        return CTRL_TYPE_OBJECT;
    } else {
        return CTRL_TYPE_STRUCTURE;
    }
}
```

## 컨트롤 처리 순서

### 기본 처리 흐름

1. **컨트롤 헤더 읽기** - HWPTAG_CTRL_HEADER
2. **컨트롤 ID 확인** - 4바이트 컨트롤 ID
3. **타입별 처리**:
   - **구조 컨트롤**: 문단 리스트 포함 여부 확인
   - **필드 컨트롤**: command 문자열 파싱
   - **개체 컨트롤**: 개체별 속성 파싱
4. **하위 데이터 처리** - 각 컨트롤에 따른 추가 데이터

### 확장 컨트롤 처리

새로운 버전에서 추가된 알 수 없는 컨트롤 ID의 경우:

- **기본 컨트롤 구조**는 동일하게 처리
- **추가 데이터**는 크기만큼 건너뛰기
- **문단 리스트** 포함 여부는 level 정보로 판단

---

_이 참조표는 한글 문서 파일 형식 5.0에서 사용되는 모든 공개된 컨트롤 ID를 포함합니다._

## 관련 표 (원문)

- 표 64~66: 컨트롤 헤더/문단 리스트 헤더/컨트롤 임의 데이터
- 표 127~128: 개체 이외의 컨트롤/필드 컨트롤 ID
