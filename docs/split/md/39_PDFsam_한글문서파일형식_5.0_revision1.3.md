# 한글 문서 파일 형식 5.0

### 표 58 문단 헤더 (계속)

| 자료형 | 길이(바이트) | 설명 |
|--------|------------|------|
| UINT16 | 2 | range tag 정보 수 |
| UINT16 | 2 | 각 줄에 대한 align에 대한 정보 수 |
| UINT32 | 4 | 문단 Instance ID (unique ID) |
| UINT16 | 2 | 변경추적 병합 문단여부. (5.0.3.2 버전 이상) |
| 전체 길이 | 24 |  |

### 표 59 단 나누기 종류

| 값 | 설명 |
|----|------|
| 0x01 | 구역 나누기 |
| 0x02 | 다단 나누기 |
| 0x04 | 쪽 나누기 |
| 0x08 | 단 나누기 |

텍스트의 수가 1 이상이면 문자 수만큼 텍스트를 로드하고 그렇지 않을 경우 PARA_BREAK로 문단을 생성한다.

## 4.3.2. 문단의 텍스트

Tag ID : HWPTAG_PARA_TEXT

| 자료형 | 길이(바이트) | 설명 |
|--------|------------|------|
| WCHAR array[sizeof(nchars)] | 2×nchars | 문자수만큼의 텍스트 |
| 전체 길이 | 가변 | (2×nchars) 바이트 |

### 표 60 문단 텍스트

문단은 최소 하나의 문자 Shape buffer가 존재하며, 첫 번째 pos가 반드시 0이어야 한다.

예를 들어 문자길이 40자 짜리 문단이 10자씩 4가지 다른 글자 모양으로 구성되어 있다면 buffer는 다음과 같다.

| 모양 1 | 모양 2 | 모양 3 | 모양 4 |
|-------|-------|-------|-------|
| m_Pos=0, m_ID=1 | m_Pos=10, m_ID=2 | m_Pos=20, m_ID=3 | m_Pos=30, m_ID=4 |

### 그림 47 문단 버퍼 구조

텍스트 문자 Shape 레코드를 글자 모양 정보 수(Character Shapes)만큼 읽는다.

## 4.3.3. 문단의 글자 모양

Tag ID : HWPTAG_PARA_CHAR_SHAPE

| 자료형 | 길이(바이트) | 설명 |
|--------|------------|------|
| UINT32 | 4 | 글자 모양이 바뀌는 시작 위치 |
| UINT32 | 4 | 글자 모양 ID |
| 전체 길이 | 가변 | 8×n |

### 표 61 문단의 글자 모양

---
*페이지: 34*

34