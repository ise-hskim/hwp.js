# 스토리지

한글 문서 파일에서 사용되는 주요 스토리지에 대한 설명입니다.

## 스토리지 목록

### 1. 루트 스토리지
- **이름**: (루트)
- **설명**: 최상위 컨테이너
- **포함 내용**: 모든 하위 스토리지와 스트림

### 2. BodyText 스토리지
- **이름**: `BodyText`
- **설명**: 문서의 본문 내용을 저장
- **포함 스트림**:
  - `Section0`, `Section1`, ... : 각 구역(섹션)의 본문
- **특징**: 
  - 문서는 최소 하나의 섹션을 가짐
  - 각 섹션은 독립적인 레이아웃 설정 가능

### 3. BinData 스토리지
- **이름**: `BinData`
- **설명**: 바이너리 데이터(이미지, OLE 객체 등) 저장
- **포함 스트림**:
  - `BIN0001.확장자`, `BIN0002.확장자`, ... : 각 바이너리 데이터
- **명명 규칙**:
  - BIN + 4자리 일련번호 + 확장자
  - 예: `BIN0001.jpg`, `BIN0002.png`

### 4. Scripts 스토리지
- **이름**: `Scripts`
- **설명**: 문서에 포함된 스크립트 저장
- **포함 스트림**:
  - `JScript`: JavaScript 코드
  - `VBScript`: Visual Basic Script 코드
- **용도**: 문서 자동화, 매크로 기능

### 5. DocOptions 스토리지
- **이름**: `DocOptions`
- **설명**: 문서별 추가 옵션 저장
- **포함 가능한 스트림**:
  - 연결 문서 정보
  - 배포 문서 정보
  - DRM 정보

### 6. XMLTemplate 스토리지
- **이름**: `XMLTemplate`
- **설명**: XML 기반 템플릿 정보
- **용도**: 양식 문서, 구조화된 문서 템플릿

## 스토리지 접근 순서

1. 루트 스토리지 열기
2. 필요한 하위 스토리지 열기
3. 스토리지 내의 스트림 접근
4. 데이터 읽기/쓰기
5. 역순으로 닫기

## 스토리지 속성

각 스토리지는 다음 속성을 가집니다:

| 속성 | 설명 |
|------|------|
| 이름 | 스토리지 식별자 |
| CLSID | 클래스 식별자 (선택적) |
| 생성 시간 | 스토리지 생성 시각 |
| 수정 시간 | 마지막 수정 시각 |
| 속성 플래그 | 읽기 전용, 숨김 등 |

## 새 스토리지 추가

한글은 알 수 없는 스토리지를 무시하므로, 호환성을 유지하면서 새로운 기능을 추가할 수 있습니다:

```
한글파일.hwp
├─ ... (기존 스토리지)
└─ CustomData (새 스토리지)
   └─ MyData (사용자 정의 스트림)
```

## 주의사항

1. **필수 스토리지**: `BodyText`는 반드시 존재해야 함
2. **이름 제한**: 스토리지 이름은 31자 이하
3. **중복 금지**: 같은 레벨에서 동일한 이름 사용 불가
4. **순서 무관**: 스토리지의 물리적 순서는 중요하지 않음