# 한글 파일 구조

## 3.1 파일 구조 요약

HWP 파일은 Windows **복합 파일(Compound File)** 구조를 사용합니다.
- **스토리지(Storage)**: 폴더와 유사한 컨테이너
- **스트림(Stream)**: 실제 데이터를 저장하는 파일

## 전체 구조

| 구성요소 | 스토리지/스트림 이름 | 길이 | 레코드구조 | 압축/암호화 |
|---------|---------------------|------|-----------|------------|
| **파일 인식 정보** | FileHeader | 고정 | ❌ | ❌ |
| **문서 정보** | DocInfo | 고정 | ✅ | ✅ |
| **본문** | BodyText (스토리지) | 가변 | ✅ | ✅ |
| | ㄴ Section0 | | | |
| | ㄴ Section1 | | | |
| | ㄴ ... | | | |
| **문서 요약** | \005HwpSummaryInformation | 고정 | ❌ | ❌ |
| **바이너리 데이터** | BinData (스토리지) | 가변 | ❌ | ✅ |
| | ㄴ BinaryData0 | | | |
| | ㄴ BinaryData1 | | | |
| | ㄴ ... | | | |
| **미리보기 텍스트** | PrvText | 고정 | ❌ | ❌ |
| **미리보기 이미지** | PrvImage | 가변 | ❌ | ❌ |
| **문서 옵션** | DocOptions (스토리지) | 가변 | ❌ | ❌ |
| | ㄴ _LinkDoc | | | |
| | ㄴ DrmLicense | | | |
| | ㄴ ... | | | |
| **스크립트** | Scripts (스토리지) | 가변 | ❌ | ❌ |
| | ㄴ DefaultJScript | | | |
| | ㄴ JScriptVersion | | | |
| | ㄴ ... | | | |
| **XML 템플릿** | XMLTemplate (스토리지) | 가변 | ❌ | ❌ |
| | ㄴ Schema | | | |
| | ㄴ Instance | | | |
| | ㄴ ... | | | |
| **문서 이력 관리** | DocHistory (스토리지) | 가변 | ✅ | ✅ |
| | ㄴ VersionLog0 | | | |
| | ㄴ VersionLog1 | | | |
| | ㄴ ... | | | |

## 압축 처리

1. **압축 확인**: FileHeader의 압축 플래그 확인
2. **압축 해제**: zlib 사용
3. **처리 기준**: 모든 설명은 압축 해제된 상태 기준

## 레코드 구조 사용

레코드 구조를 사용하는 스트림:
- DocInfo
- BodyText (모든 Section)
- DocHistory

레코드 구조는 확장성과 하위 호환성을 제공하는 핵심 메커니즘입니다.