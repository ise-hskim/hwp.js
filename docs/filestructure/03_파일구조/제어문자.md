# 제어 문자 (Control Character)

## 개요

문단 내에서 일반 문자로 표현할 수 없는 요소(표, 그림 등)를 표현하기 위해 문자 코드 0-31을 특수 용도로 사용합니다.

## 중요 사항

⚠️ **주의**: 제어 문자를 일반 문자로 처리하면 문서를 정상적으로 읽을 수 없음
- 제어 문자 중 일부는 독자적인 문단 리스트 포함
- 제어 문자 발견 시 종류에 따라 읽기/스킵 처리 필요

## 제어 문자 형식

### 1. 문자 컨트롤 (char)
- **크기**: 1 바이트
- **특징**: 부가정보 없이 문자 하나로 표현

```
위치: | 0 | 1 | 2 | 3  | 4 | 5 | 6 | 7 | 8 | 9 | 10 | 11 |
내용: |'A'|'B'|'C'| ch |'D'|'E'|'F'|'G'|'H'|'I'|'J' | 13 |
                   ↑
              제어 문자(1 byte)
```

### 2. 인라인 컨트롤 (inline)  
- **크기**: 8 바이트 (제어문자 1 + 부가정보 6 + 종료문자 1)
- **특징**: 부가정보가 12바이트(6 WCHAR) 이내
- **제한**: 부가정보가 12바이트 초과 시 확장 컨트롤로 대체

```
위치: | 0 | 1 | 2  | 3-8 (info) | 9  | 10 | 11 |
내용: |'A'|'B'| ch |  부가정보  | ch |'C' | 13 |
                ↑                 ↑
           시작(1 byte)      종료(1 byte)
```

### 3. 확장 컨트롤 (extended)
- **크기**: 8 바이트 (제어문자 1 + 포인터 6 + 종료문자 1)
- **특징**: 포인터가 실제 오브젝트를 가리킴
- **용도**: 복잡한 구조(표, 그림 등) 표현

```
위치: | 0 | 1 | 2  | 3-8 (pointer) | 9  | 10 | 11 |
내용: |'A'|'B'| ch |    포인터     | ch |'C' | 13 |
                ↑                     ↑
           시작(1 byte)          종료(1 byte)
                        ↓
                [실제 오브젝트 데이터]
```

## 제어 문자 코드표 (표 6)

| 코드 | 설명 | 형식 | 용도 |
|------|------|------|------|
| **0** | 사용 불가 | char | - |
| **1** | 예약 | extended | - |
| **2** | 구역 정의/단 정의 | extended | 섹션/컬럼 설정 |
| **3** | 필드 시작 | extended | 다양한 필드 |
| | ㄴ 누름틀, 하이퍼링크, 블록 책갈피 | | |
| | ㄴ 표 계산식, 문서 요약, 사용자 정보 | | |
| | ㄴ 날짜/시간, 파일 경로, 상호 참조 | | |
| | ㄴ 메일 머지, 메모, 교정부호, 개인정보 | | |
| **4** | 필드 끝 | inline | 필드 종료 마커 |
| **5-7** | 예약 | inline | - |
| **8** | title mark | inline | 제목 표시 |
| **9** | 탭 | inline | 탭 문자 |
| **10** | 한 줄 끝 (line break) | char | 줄바꿈 |
| **11** | 그리기 개체/표 | extended | 도형, 표 |
| **12** | 예약 | extended | - |
| **13** | 문단 끝 (para break) | char | 문단 종료 |
| **14** | 예약 | extended | - |
| **15** | 숨은 설명 | extended | 숨김 텍스트 |
| **16** | 머리말/꼬리말 | extended | 페이지 머리/꼬리 |
| **17** | 각주/미주 | extended | 주석 |
| **18** | 자동번호 | extended | 각주, 표 번호 등 |
| **19-20** | 예약 | inline | - |
| **21** | 페이지 컨트롤 | extended | 페이지 설정 |
| | ㄴ 감추기, 새 번호로 시작 등 | | |
| **22** | 책갈피/찾아보기 표식 | extended | 북마크 |
| **23** | 덧말/글자 겹침 | extended | 텍스트 장식 |
| **24** | 하이픈 | char | 하이픈 문자 |
| **25-29** | 예약 | char | - |
| **30** | 묶음 빈칸 | char | 공백 묶음 |
| **31** | 고정폭 빈칸 | char | 고정 공백 |

## 처리 알고리즘

```c
while (reading_paragraph) {
    char ch = read_char();
    
    if (ch >= 0 && ch <= 31) {
        // 제어 문자 발견
        switch (control_type[ch]) {
            case CHAR_CONTROL:
                // 1바이트 처리
                process_char_control(ch);
                break;
                
            case INLINE_CONTROL:
                // 8바이트 처리
                info = read_bytes(6);
                end_ch = read_char();
                process_inline_control(ch, info);
                break;
                
            case EXTENDED_CONTROL:
                // 8바이트 읽고 확장 데이터 처리
                pointer = read_bytes(6);
                end_ch = read_char();
                process_extended_control(ch, pointer);
                break;
        }
    } else {
        // 일반 문자 처리
        process_normal_char(ch);
    }
}