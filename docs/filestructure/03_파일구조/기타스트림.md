# 기타 스트림

## 문서 요약 (\005HwpSummaryInformation)

한글 메뉴의 "파일-문서 정보-문서 요약"에서 입력한 내용을 저장합니다.

### 속성 목록 (표 7)

| 속성명 | Property ID | 값 | VT 타입 | 설명 |
|--------|------------|-----|---------|------|
| **Title** | PIDSI_TITLE | 0x00000002 | VT_LPSTR | 제목 |
| **Subject** | PIDSI_SUBJECT | 0x00000003 | VT_LPSTR | 주제 |
| **Author** | PIDSI_AUTHOR | 0x00000004 | VT_LPSTR | 작성자 |
| **Keywords** | PIDSI_KEYWORDS | 0x00000005 | VT_LPSTR | 키워드 |
| **Comments** | PIDSI_COMMENTS | 0x00000006 | VT_LPSTR | 설명 |
| **Last Saved By** | PIDSI_LASTAUTHOR | 0x00000008 | VT_LPSTR | 마지막 저장자 |
| **Revision Number** | PIDSI_REVNUMBER | 0x00000009 | VT_LPSTR | 개정 번호 |
| **Last Printed** | PIDSI_LASTPRINTED | 0x0000000B | VT_FILETIME | 마지막 인쇄 시간 (UTC) |
| **Create Time/Date** | PIDSI_CREATE_DTM | 0x0000000C | VT_FILETIME | 작성 시간 (UTC) |
| **Last saved Time/Date** | PIDSI_LASTSAVE_DTM | 0x0000000D | VT_FILETIME | 마지막 저장 시간 (UTC) |
| **Number of Pages** | PIDSI_PAGECOUNT | 0x0000000E | VT_I4 | 페이지 수 |
| **Date String** (*사용자 정의*) | HWPPIDSI_DATE_STR | 0x00000014 | VT_LPSTR | 날짜 문자열 |
| **Para Count** (*사용자 정의*) | HWPPIDSI_PARACOUNT | 0x00000015 | VT_I4 | 문단 수 |

> **참고**: Windows Summary Information Property Set 표준을 따름
> - MSDN: The Summary Information Property Set
> - MSDN: The DocumentSummaryInformation and UserDefined Property Set

### 데이터 타입
- **VT_LPSTR**: 문자열
- **VT_FILETIME**: 64비트 시간 값 (UTC)
- **VT_I4**: 32비트 정수

## 바이너리 데이터 (BinData)

문서에 첨부된 바이너리 데이터를 저장하는 스토리지입니다.

### 구조
```
BinData (스토리지)
├── BinaryData0 (스트림) - 첫 번째 바이너리 데이터
├── BinaryData1 (스트림) - 두 번째 바이너리 데이터
├── BinaryData2 (스트림) - 세 번째 바이너리 데이터
└── ...
```

### 저장 내용
- 그림 파일 (JPEG, PNG, BMP 등)
- OLE 개체
- 임베디드 폰트
- 기타 첨부 파일

### 특징
- 각 바이너리 데이터는 독립된 스트림
- 본문에서 ID로 참조
- 압축 가능

## 미리보기 텍스트 (PrvText)

문서의 텍스트 미리보기를 저장합니다.

### 특징
- **형식**: 유니코드 문자열 (UTF-16LE)
- **용도**: 빠른 문서 미리보기
- **내용**: 문서 본문의 텍스트만 추출
- **크기**: 고정

### 사용 예
- 파일 탐색기 미리보기
- 검색 인덱싱
- 빠른 내용 확인

## 미리보기 이미지 (PrvImage)

문서의 썸네일 이미지를 저장합니다.

### 특징
- **형식**: BMP 또는 GIF
- **용도**: 시각적 미리보기
- **크기**: 가변
- **압축**: 미적용

### 사용 예
- 파일 탐색기 썸네일
- 문서 선택 대화상자
- 최근 문서 목록

## 문서 옵션 (DocOptions)

문서 보안 및 연결 정보를 저장하는 스토리지입니다.

### 스트림 구조
| 스트림명 | 설명 |
|---------|------|
| **_LinkDoc** | 연결된 문서의 경로 |
| **DrmLicense** | DRM Packaging Version 정의 |
| **DrmRootSect** | 암호화 알고리즘 |
| **CertDrmHeader** | DRM Packaging Version 정의 |
| **CertDrmInfo** | 공인인증서 DRM 정보 |
| **DigitalSignature** | 전자 서명 정보 |
| **PublicKeyInfo** | 공개 키 정보 |

## 스크립트 (Scripts)

문서에 포함된 스크립트를 저장하는 스토리지입니다.

### JScriptVersion 스트림 (표 8)
| 자료형 | 길이(바이트) | 설명 |
|--------|------------|------|
| DWORD | 4 | 스크립트 버전 HIGH |
| DWORD | 4 | 스크립트 버전 LOW |
| **전체 길이** | **8** | |

### DefaultJScript 스트림 (표 9)
| 자료형 | 길이(바이트) | 설명 |
|--------|------------|------|
| DWORD | 4 | 스크립트 헤더 길이 (len1) |
| WCHAR array[len1] | 2×len1 | 스크립트 헤더 |
| DWORD | 4 | 스크립트 소스 길이 (len2) |
| WCHAR array[len2] | 2×len2 | 스크립트 소스 |
| DWORD | 4 | 스크립트 Pre 소스 길이 (len3) |
| WCHAR array[len3] | 2×len3 | 스크립트 Pre 소스 |
| DWORD | 4 | 스크립트 Post 소스 길이 (len4) |
| WCHAR array[len4] | 2×len4 | 스크립트 Post 소스 |
| DWORD | 4 | 스크립트 end flag (-1) |
| **전체 길이** | **20 + (2×len1) + (2×len2) + (2×len3) + (2×len4)** | |

## XML 템플릿 (XMLTemplate)

XML Template 정보를 저장하는 스토리지입니다.

### _SchemaName 스트림 (표 10)
| 자료형 | 길이(바이트) | 설명 |
|--------|------------|------|
| DWORD | 4 | Schema 이름 길이 (len1) |
| WCHAR array[len1] | 2×len1 | Schema 이름 |
| **전체 길이** | **4 + (2×len1)** | |

### Schema 스트림 (표 11)
| 자료형 | 길이(바이트) | 설명 |
|--------|------------|------|
| DWORD | 4 | Schema 길이 (len1) |
| WCHAR array[len1] | 2×len1 | Schema |
| **전체 길이** | **4 + (2×len1)** | |

### Instance 스트림 (표 12)
| 자료형 | 길이(바이트) | 설명 |
|--------|------------|------|
| DWORD | 4 | Instance 길이 (len1) |
| WCHAR array[len1] | 2×len1 | Instance |
| **전체 길이** | **4 + (2×len1)** | |

## 문서 이력 관리 (DocHistory)

파일 메뉴의 "문서 이력 관리"에서 표시 및 생성되는 문서의 이력 정보를 저장합니다.

### 특징
- 각 이력을 **히스토리** 또는 **히스토리 아이템**이라 부름
- **VersionLog%d** 형식의 스트림명 (%d는 버전 번호)
- 각 아이템은 **압축 및 암호화**되어 저장
- 하위 호환성을 위한 구조화된 저장 방식

### 버전 정보 스토리지 구조
```
DocHistory : 스토리지
├─ VersionLog0 : 이력 정보 스트림
├─ VersionLog1 : 이력 정보 스트림
├─ VersionLog2 : 이력 정보 스트림
├─ ...
└─ HistoryLastDoc : 최종문서 스트림
```

### 히스토리 아이템 스트림 구조
```
히스토리 아이템
├─ 아이템 시작 레코드
├─ 히스토리 정보 레코드 1
├─ 히스토리 정보 레코드 2
├─ 히스토리 정보 레코드 3
├─ ... (사용자, 시간, 날짜 등)
├─ 이력 정보 데이터 레코드
└─ 아이템 끝 레코드
```

### 레코드 구성

**RECORD_HEADER**
| 자료형 | 설명 |
|--------|------|
| BYTE | 레코드 Type |
| UINT | 추가 데이터 블록 (RD) BYTE 크기 |

**RECORD_DATA (RD)**
| 자료형 | 설명 |
|--------|------|
| DATA | 레코드 Type에 따른 다양한 정보 (스트링, Bit flag 등) |

## 참고문헌 (Bibliography)

참고문헌 정보를 XML 파일 형태로 저장하는 스토리지입니다.