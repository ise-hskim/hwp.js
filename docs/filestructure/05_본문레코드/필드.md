# 필드 (Field)

필드는 동적으로 변경될 수 있는 특수한 텍스트 영역입니다. 날짜, 시간, 페이지 번호, 하이퍼링크 등 다양한 종류의 필드가 있습니다.

## 필드 구조 (표 152)

| 자료형 | 길이(바이트) | 설명 |
|--------|------------|------|
| UINT32 | 4 | ctrl ID (필드 종류별 고유 ID) |
| UINT | 4 | 속성 (표 153 참조) |
| BYTE | 1 | 기타 속성 |
| WORD | 2 | command 길이 (len) |
| WCHAR array[len] | 2×len | command (각 필드 종류마다 처리해야 할 고유 정보) |
| UINT32 | 4 | id (문서 내 고유 아이디) |
| **전체 길이** | **가변** | **15 + (2×len)** |

## 필드 속성 (표 153)

| 범위 | 구분 | 값 | 설명 |
|------|-----|----|----- |
| bit 0 | 읽기 전용 상태에서도 수정 가능한지 여부 | | |
| bit 11-14 | 하이퍼링크 필드 업데이트 시<br>글자 속성 업데이트 종류 | 0x1 | 열어보지 않은 링크 |
|           |                                      | 0x2 | 열어본 링크 |
|           |                                      | 0x4 | 링크 생성 |
| bit 15 | 필드 내용이 수정되었는지 여부 | | |

## 필드 종류별 상세

### 날짜/시간 필드

#### FIELD_DATE ('%dte')
현재 날짜를 표시합니다.
- command 예시: "yyyy년 MM월 dd일"
- 결과: "2024년 01월 15일"

#### FIELD_DOCDATE ('%ddt')
문서 작성 날짜를 표시합니다.

### 문서 정보 필드

#### FIELD_PATH ('%pat')
문서 파일 경로를 표시합니다.
- command: 경로 표시 형식
- 결과: "C:\Documents\sample.hwp"

#### FIELD_SUMMARY ('%smr')
문서 요약 정보를 표시합니다.
- 제목, 작성자, 키워드 등

#### FIELD_USERINFO ('%usr')
사용자 정보를 표시합니다.
- 이름, 소속, 직책 등

### 참조 필드

#### FIELD_BOOKMARK ('%bmk')
책갈피 참조
- command: 책갈피 이름
- 책갈피 위치의 텍스트나 페이지 번호 표시

#### FIELD_CROSSREF ('%xrf')
상호 참조
- 그림, 표, 수식 번호 참조
- 제목 텍스트 참조

### 메일 머지 필드

#### FIELD_MAILMERGE ('%mmg')
메일 머지 기능
- command: 데이터베이스 필드명
- 대량 문서 생성 시 사용

### 수식 필드

#### FIELD_FORMULA ('%fmu')
계산 수식
- command: 수식 표현식
- 예: "=SUM(A1:A10)"

### 하이퍼링크 필드

#### FIELD_HYPERLINK ('%hlk')
하이퍼링크
- command: URL 또는 파일 경로
- 클릭 시 해당 위치로 이동

### 하이퍼링크 상태
- **열어보지 않은 링크**: 파란색 밑줄
- **열어본 링크**: 보라색 밑줄
- **링크 생성**: 링크 생성 시 스타일

### 대화형 필드

#### FIELD_CLICKHERE ('%clk')
클릭 가능한 영역
- 사용자 입력을 받는 양식 필드
- 체크박스, 드롭다운 등

## Command 형식

각 필드 종류별로 command 형식이 다릅니다:

### 날짜 형식
```
yyyy: 연도 4자리
yy: 연도 2자리
MM: 월 2자리
dd: 일 2자리
HH: 시간(24시간)
mm: 분
ss: 초
```

### 참조 형식
```
bookmark_name: 책갈피 이름
table_1: 표 번호
figure_2: 그림 번호
```

### URL 형식
```
http://www.example.com
mailto:user@example.com
file:///C:/Documents/file.pdf
```

## 필드 업데이트

필드는 다음과 같은 경우에 자동으로 업데이트됩니다:
- 문서 열기 시
- 인쇄 시
- 수동 업데이트 명령 실행 시
- 특정 이벤트 발생 시 (저장, 페이지 이동 등)

## 읽기 전용 모드에서의 동작

bit 0이 설정된 필드는 문서가 읽기 전용 모드일 때도 업데이트됩니다:
- 날짜/시간 필드
- 페이지 번호 필드
- 자동 계산 필드