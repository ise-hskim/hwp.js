# 그리기 개체

## 개요

그리기 개체는 선, 사각형, 타원, 호, 다각형, 곡선 등의 도형을 나타냅니다.

### Serialization 순서
1. 그리기 개체 공통 속성을 serialize
2. 각 개체별 요소 속성을 serialize

## 그리기 개체 공통 속성 (표 81)

| 자료형 | 길이(바이트) | 설명 |
|--------|------------|------|
| BYTE stream | n | 개체 요소 속성 (표 82 참조) |
| BYTE stream | 11 | 테두리 선 정보 (표 86 참조) |
| BYTE stream | n2 | 채우기 정보 (표 28 참조) |
| BYTE stream | 12 | 글상자 속성 (있는 경우) |
| **전체 길이** | **가변** | **23 + n + n2** |

## 개체 요소 (HWPTAG_SHAPE_COMPONENT)

Tag ID: 0x04C

> **참고**: GenShapeObject일 경우 id가 두 번 기록됨

## 그리기 개체 종류

### 1. 선 (HWPTAG_SHAPE_COMPONENT_LINE)
- Tag ID: 0x04E
- 컨트롤 ID: `MAKE_4CHID('$', 'l', 'i', 'n')`

### 2. 사각형 (HWPTAG_SHAPE_COMPONENT_RECTANGLE)
- Tag ID: 0x04F
- 컨트롤 ID: `MAKE_4CHID('$', 'r', 'e', 'c')`

### 3. 타원 (HWPTAG_SHAPE_COMPONENT_ELLIPSE)
- Tag ID: 0x050
- 컨트롤 ID: `MAKE_4CHID('$', 'e', 'l', 'l')`

### 4. 호 (HWPTAG_SHAPE_COMPONENT_ARC)
- Tag ID: 0x051
- 컨트롤 ID: `MAKE_4CHID('$', 'a', 'r', 'c')`

### 5. 다각형 (HWPTAG_SHAPE_COMPONENT_POLYGON)
- Tag ID: 0x052
- 컨트롤 ID: `MAKE_4CHID('$', 'p', 'o', 'l')`

### 6. 곡선 (HWPTAG_SHAPE_COMPONENT_CURVE)
- Tag ID: 0x053
- 컨트롤 ID: `MAKE_4CHID('$', 'c', 'u', 'r')`

## 테두리 선 정보

그리기 개체의 외곽선 스타일을 정의합니다:
- 선 종류 (실선, 점선, 파선 등)
- 선 굵기
- 선 색상
- 화살표 정보

## 채우기 정보

그리기 개체 내부 채우기를 정의합니다:
- 단색 채우기
- 그라데이션 채우기
- 이미지 채우기
- 패턴 채우기

## 글상자 속성

그리기 개체 내부에 텍스트를 포함할 수 있는 경우:
- 텍스트 정렬
- 여백 정보
- 문단 리스트 참조

## 개체 요소 속성 상세 (표 82, 83)

### 기본 속성 (표 82)
| 자료형 | 길이(바이트) | 설명 |
|--------|------------|------|
| UINT32 | 4 | 개체 컨트롤 ID |
| **전체 길이** | **4** | |

### 확장 속성 (표 83)
| 자료형 | 길이(바이트) | 설명 |
|--------|------------|------|
| INT32 | 4 | 개체가 속한 그룹 내에서의 X offset |
| INT32 | 4 | 개체가 속한 그룹 내에서의 Y offset |
| WORD | 2 | 몇 번이나 그룹 되었는지 |
| WORD | 2 | 개체 요소의 local file version |
| UINT32 | 4 | 개체 생성 시 초기 폭 |
| UINT32 | 4 | 개체 생성 시 초기 높이 |
| UINT32 | 4 | 개체의 현재 폭 |
| UINT32 | 4 | 개체의 현재 높이 |
| UINT32 | 4 | 속성 |
| HWPUNIT16 | 2 | 회전각 |
| INT32 | 4 | 회전 중심의 x 좌표 (개체 좌표계) |
| INT32 | 4 | 회전 중심의 y 좌표 (개체 좌표계) |
| BYTE stream | n | Rendering 정보 (표 84 참조) |
| **전체 길이** | **가변** | **42 + n** |

### 속성 비트 필드
| 비트 | 설명 |
|------|------|
| bit 0 | horz flip (가로 뒤집기) |
| bit 1 | vert flip (세로 뒤집기) |

## Rendering 정보 (표 84)

| 자료형 | 길이(바이트) | 설명 |
|--------|------------|------|
| WORD | 2 | scale matrix와 rotation matrix 쌍의 개수 (cnt)<br>초기값 1, group 시 증가, ungroup 시 감소 |
| BYTE stream | 48 | translation matrix (표 85 참조) |
| BYTE stream | cnt×48×2 | scale matrix/rotation matrix sequence (표 85 참조) |
| **전체 길이** | **가변** | **50 + (cnt×48×2)** |

## Matrix 정보 (표 85)

각 matrix는 원소가 double로 표현되는 3×3 matrix입니다. 마지막 줄은 항상 [0, 0, 1]이므로 실제로는 저장하지 않습니다.

| 자료형 | 길이(바이트) | 설명 |
|--------|------------|------|
| double array[6] | 48 | 3×2 matrix의 원소 |
| **전체 길이** | **48** | |

## 테두리 선 정보 (표 86)

| 자료형 | 길이(바이트) | 설명 |
|--------|------------|------|
| COLORREF | 4 | 선 색상 |
| INT16 | 2 | 선 굵기 |
| UINT32 | 4 | 속성 (표 87 참조) |
| BYTE | 1 | Outline style (표 88 참조) |
| **전체 길이** | **11** | |

### 테두리 선 속성 (표 87)
| 범위 | 구분 | 값 | 설명 |
|------|------|----|----- |
| **bit 0~5** | 선 종류 | | |
| **bit 6~9** | 선 끝 모양 | | |
| | | 0 | round - 그림일 때는 "Round", 그리기 개체일 때는 "Flat"이 디폴트 |
| | | 1 | flat |
| **bit 10~15** | 화살표 시작 모양 | | |
| **bit 16~21** | 화살표 끝 모양 | | |
| | | 0 | 모양 없음 |
| | | 1 | 화살 모양 |
| | | 2 | 오목한 화살모양 |
| | | 3 | 속이 빈 다이아몬드 모양 |
| | | 4 | 속이 빈 원 모양 |
| | | 5 | 속이 빈 사각 모양 |
| | | 6 | 속이 채워진 다이아몬드 모양 |
| | | 7 | 속이 채워진 원 모양 |
| | | 8 | 속이 채워진 사각 모양 |
| **bit 22~25** | 화살표 시작 크기 | | |
| **bit 26~29** | 화살표 끝 크기 | | |
| | | 0 | 작은-작은 |
| | | 1 | 작은-중간 |
| | | 2 | 작은-큰 |
| | | 3 | 중간-작은 |
| | | 4 | 중간-중간 |
| | | 5 | 중간-큰 |
| | | 6 | 큰-작은 |
| | | 7 | 큰-중간 |
| | | 8 | 큰-큰 |
| bit 30 | 시작부분 화살표 채움 여부 | | |
| bit 31 | 끝부분 화살표 채움 여부 | | |

### Outline Style (표 88)
| 값 | 설명 |
|----|------|
| 0 | normal |
| 1 | outer |
| 2 | inner |

## 그리기 개체 글상자용 텍스트 정보 (표 89)

| 자료형 | 길이(바이트) | 설명 |
|--------|------------|------|
| BYTE stream | 12 | 그리기 개체 글상자용 텍스트 속성 (표 90 참조) |
| BYTE stream | n | 문단 리스트 헤더 (표 65 참조) |
| **전체 길이** | **가변** | **12 + n** |

### 글상자용 텍스트 속성 (표 90)
| 자료형 | 길이(바이트) | 설명 |
|--------|------------|------|
| HWPUNIT16 | 2 | 글상자 텍스트 왼쪽 여백 |
| HWPUNIT16 | 2 | 글상자 텍스트 오른쪽 여백 |
| HWPUNIT16 | 2 | 글상자 텍스트 위쪽 여백 |
| HWPUNIT16 | 2 | 글상자 텍스트 아래쪽 여백 |
| HWPUNIT | 4 | 텍스트 문자열의 최대 폭<br>(보통 그리기 개체의 가로 크기와 동일) |
| **전체 길이** | **12** | |