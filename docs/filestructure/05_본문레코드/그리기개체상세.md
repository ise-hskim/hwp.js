# 그리기 개체 상세

## 선 개체 (HWPTAG_SHAPE_COMPONENT_LINE)

Tag ID: 0x04E | 크기: 가변

### 구조 (표 91)
| 자료형 | 길이(바이트) | 설명 |
|--------|------------|------|
| BYTE stream | n | 개체 공통 속성 (표 68 참조) |
| BYTE stream | n2 | 그리기 개체 공통 속성 (표 81 참조) |
| BYTE stream | 18 | 선 개체 속성 (표 92 참조) |
| **전체 길이** | **가변** | **18 + n + n2** |

### 선 개체 속성 (표 92)
| 자료형 | 길이(바이트) | 설명 |
|--------|------------|------|
| INT32 | 4 | 시작점 X 좌표 |
| INT32 | 4 | 시작점 Y 좌표 |
| INT32 | 4 | 끝점 X 좌표 |
| INT32 | 4 | 끝점 Y 좌표 |
| UINT16 | 2 | 속성<br>처음 생성 시 수직/수평선의 방향 보정 플래그 |
| **전체 길이** | **18** | |

> **참고**: 수직 또는 수평선일 때 선의 방향이 언제나 오른쪽(위쪽)으로 잡히는 현상을 보정하기 위한 플래그

## 사각형 개체 (HWPTAG_SHAPE_COMPONENT_RECTANGLE)

Tag ID: 0x04F | 크기: 가변

### 구조 (표 93)
| 자료형 | 길이(바이트) | 설명 |
|--------|------------|------|
| BYTE stream | n | 개체 공통 속성 (표 68 참조) |
| BYTE stream | n2 | 그리기 개체 공통 속성 (표 81 참조) |
| BYTE stream | 33 | 사각형 개체 속성 (표 94 참조) |
| **전체 길이** | **가변** | **33 + n + n2** |

### 사각형 개체 속성 (표 94)
| 자료형 | 길이(바이트) | 설명 |
|--------|------------|------|
| BYTE | 1 | 사각형 모서리 곡률(%)<br>0: 직각<br>20: 둥근 모양<br>50: 반원 |
| INT32 array[4] | 16 | 사각형의 X 좌표 4개 |
| INT32 array[4] | 16 | 사각형의 Y 좌표 4개 |
| **전체 길이** | **33** | |

## 타원 개체 (HWPTAG_SHAPE_COMPONENT_ELLIPSE)

Tag ID: 0x050 | 크기: 가변

### 구조 (표 95)
| 자료형 | 길이(바이트) | 설명 |
|--------|------------|------|
| BYTE stream | n | 개체 공통 속성 (표 68 참조) |
| BYTE stream | n2 | 그리기 개체 공통 속성 (표 81 참조) |
| BYTE stream | 60 | 타원 개체 속성 (표 96 참조) |
| **전체 길이** | **가변** | **60 + n + n2** |

### 타원 개체 속성 (표 96)
| 자료형 | 길이(바이트) | 설명 |
|--------|------------|------|
| UINT32 | 4 | 속성 (표 97 참조) |
| INT32 | 4 | 중심 좌표의 X 값 |
| INT32 | 4 | 중심 좌표의 Y 값 |
| INT32 | 4 | 제1축 X 좌표 값 |
| INT32 | 4 | 제1축 Y 좌표 값 |
| INT32 | 4 | 제2축 X 좌표 값 |
| INT32 | 4 | 제2축 Y 좌표 값 |
| INT32 | 4 | start pos x |
| INT32 | 4 | start pos y |
| INT32 | 4 | end pos x |
| INT32 | 4 | end pos y |
| INT32 | 4 | start pos x2<br>interval of curve (호일 때만 유효) |
| INT32 | 4 | start pos y2 |
| INT32 | 4 | end pos x2 |
| INT32 | 4 | end pos y2 |
| **전체 길이** | **60** | |

### 타원/호 개체 속성의 속성 (표 97)
| 범위 | 설명 |
|------|------|
| bit 0 | 호(ARC)로 바뀌었을 때, interval을 다시 계산해야 할 필요가 있는지 여부<br>(interval - 원 위에 존재하는 두 점 사이의 거리) |
| bit 1 | 호(ARC)로 바뀌었는지 여부 |
| bit 2~9 | 호(ARC)의 종류 |

## 호 개체 (HWPTAG_SHAPE_COMPONENT_ARC)

Tag ID: 0x051 | 크기: 가변

### 구조 (표 100)
| 자료형 | 길이(바이트) | 설명 |
|--------|------------|------|
| BYTE stream | n | 개체 공통 속성 (표 68 참조) |
| BYTE stream | n2 | 그리기 개체 공통 속성 (표 81 참조) |
| BYTE stream | 28 | 호 개체 속성 (표 101 참조) |
| **전체 길이** | **가변** | **28 + n + n2** |

### 호 개체 속성 (표 101)
| 자료형 | 길이(바이트) | 설명 |
|--------|------------|------|
| UINT32 | 4 | 속성 (표 97 참조) |
| INT32 | 4 | 타원의 중심 좌표 X 값 |
| INT32 | 4 | 타원의 중심 좌표 Y 값 |
| INT32 | 4 | 제1축 X 좌표 값 |
| INT32 | 4 | 제1축 Y 좌표 값 |
| INT32 | 4 | 제2축 X 좌표 값 |
| INT32 | 4 | 제2축 Y 좌표 값 |
| **전체 길이** | **28** | |

## 다각형 개체 (HWPTAG_SHAPE_COMPONENT_POLYGON)

Tag ID: 0x052 | 크기: 가변

### 구조 (표 98)
| 자료형 | 길이(바이트) | 설명 |
|--------|------------|------|
| BYTE stream | n | 개체 공통 속성 (표 68 참조) |
| BYTE stream | n2 | 그리기 개체 공통 속성 (표 81 참조) |
| BYTE stream | n3 | 다각형 개체 속성 (표 99 참조) |
| **전체 길이** | **가변** | **n + n2 + n3** |

### 다각형 개체 속성 (표 99)
| 자료형 | 길이(바이트) | 설명 |
|--------|------------|------|
| INT16 | 2 | 점의 개수 (cnt) |
| INT32 array[cnt] | 4×cnt | X 좌표 배열 |
| INT32 array[cnt] | 4×cnt | Y 좌표 배열 |
| **전체 길이** | **가변** | **2 + (8×cnt)** |

## 곡선 개체 (HWPTAG_SHAPE_COMPONENT_CURVE)

Tag ID: 0x053 | 크기: 가변

### 구조 (표 102)
| 자료형 | 길이(바이트) | 설명 |
|--------|------------|------|
| BYTE stream | n | 개체 공통 속성 (표 68 참조) |
| BYTE stream | n2 | 그리기 개체 공통 속성 (표 81 참조) |
| BYTE stream | n3 | 곡선 개체 속성 (표 103 참조) |
| **전체 길이** | **가변** | **n + n2 + n3** |

### 곡선 개체 속성 (표 103)
| 자료형 | 길이(바이트) | 설명 |
|--------|------------|------|
| INT16 | 2 | 점의 개수 (cnt) |
| INT32 array[cnt] | 4×cnt | X 좌표 배열 |
| INT32 array[cnt] | 4×cnt | Y 좌표 배열 |
| BYTE array[cnt-1] | cnt-1 | segment type<br>0: line<br>1: curve |
| **전체 길이** | **가변** | **2 + (8×cnt) + (cnt-1)** |

## 좌표 체계

모든 그리기 개체는 다음 좌표 체계를 사용:
- **단위**: HWPUNIT (1/7200 inch)
- **원점**: 개체의 왼쪽 상단
- **방향**: X축은 오른쪽, Y축은 아래쪽이 양수