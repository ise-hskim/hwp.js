# 문서 정보 레코드

DocInfo 스트림에 포함되는 주요 레코드들에 대한 설명입니다.

## HWPTAG_DOCUMENT_PROPERTIES (0x00)

문서의 전반적인 속성을 정의합니다.

```
struct DocumentProperties {
    WORD secCount;          // 구역 개수
    WORD startPageNumber;   // 시작 페이지 번호
    WORD startFootnoteNumber; // 시작 각주 번호
    WORD startEndnoteNumber;  // 시작 미주 번호
    WORD startPictureNumber;  // 시작 그림 번호
    WORD startTableNumber;    // 시작 표 번호
    WORD startEquationNumber; // 시작 수식 번호
    WORD listIdCount;        // 리스트 ID 개수
    WORD paraIdCount;        // 문단 ID 개수
    WORD startPageNumberBySection; // 구역별 페이지 시작 번호
    
    // 버전 5.0.2.5 이상
    DWORD startFootnoteNumberBySection;
    BYTE caretPosition;      // 캐럿 위치
    BYTE reserved[3];
}
```

## HWPTAG_ID_MAPPINGS (0x01)

문서 내 ID 매핑 정보를 저장합니다.

```
struct IdMappings {
    DWORD binDataCount;      // 바이너리 데이터 개수
    DWORD koreanFontCount;   // 한글 글꼴 개수
    DWORD englishFontCount;  // 영문 글꼴 개수
    DWORD hanjaFontCount;    // 한자 글꼴 개수
    DWORD japaneseFontCount; // 일본어 글꼴 개수
    DWORD etcFontCount;      // 기타 글꼴 개수
    DWORD symbolFontCount;   // 기호 글꼴 개수
    DWORD userFontCount;     // 사용자 글꼴 개수
    DWORD borderFillCount;   // 테두리/배경 개수
    DWORD charShapeCount;    // 글자 모양 개수
    DWORD tabDefCount;       // 탭 정의 개수
    DWORD numberingCount;    // 번호 매기기 개수
    DWORD bulletCount;       // 글머리표 개수
    DWORD paraShapeCount;    // 문단 모양 개수
    DWORD styleCount;        // 스타일 개수
    DWORD memoShapeCount;    // 메모 모양 개수
    DWORD trackChangeCount;  // 변경 추적 개수
    DWORD trackChangeAuthorCount; // 변경 추적 작성자 개수
}
```

## HWPTAG_BIN_DATA (0x02)

바이너리 데이터 참조 정보입니다.

```
struct BinData {
    WORD property;          // 속성 (아래 참조)
    
    // Type이 "Link"인 경우
    WORD pathLength;        // 경로 길이
    WCHAR path[pathLength]; // 파일 경로 (절대/상대)
    
    // Type이 "Embedding" 또는 "Storage"인 경우
    WORD binDataId;         // BinData 스토리지의 ID
    WORD extension_length;  // 확장자 길이
    WCHAR extension[extension_length]; // 확장자
}
```

### Property 필드 비트 구성
- bit 0-3: Type
  - 0: "Link" (연결)
  - 1: "Embedding" (포함)
  - 2: "Storage" (스토리지)
- bit 4-5: 압축 방법
  - 0: 원본 그대로
  - 1: 압축됨
  - 2: 스토리지 기본값
- bit 6-7: 상태
  - 0: 아직 접근 안 함
  - 1: 접근 성공
  - 2: 접근 실패
  - 3: 접근 실패 무시

## HWPTAG_FACE_NAME (0x03)

글꼴 정보를 저장합니다.

```
struct FaceName {
    BYTE property;          // 속성
    WORD nameLength;        // 글꼴 이름 길이
    WCHAR name[nameLength]; // 글꼴 이름
    
    // hasAlternative가 1인 경우
    BYTE alternativeType;   // 대체 글꼴 타입
    WORD altNameLength;     // 대체 글꼴 이름 길이
    WCHAR altName[altNameLength]; // 대체 글꼴 이름
    
    // 추가 정보 (5.0.3.0 이상)
    BYTE panose[10];        // PANOSE 정보
    DWORD signature;        // 글꼴 시그니처
}
```

### Property 필드 비트 구성
- bit 0: 대체 글꼴 존재 여부
- bit 1: 글꼴 유형 정보 존재
- bit 2: 기본 글꼴 여부
- bit 3-4: 미사용
- bit 5-7: 글꼴 타입
  - 0: 알 수 없음
  - 1: TTF (트루타입)
  - 2: HFT (한글 전용)

## HWPTAG_BORDER_FILL (0x04)

테두리와 배경 정보입니다.

```
struct BorderFill {
    WORD property;          // 속성
    
    // 테두리 정보
    BYTE leftType;          // 왼쪽 테두리 종류
    BYTE rightType;         // 오른쪽 테두리 종류
    BYTE topType;           // 위쪽 테두리 종류
    BYTE bottomType;        // 아래쪽 테두리 종류
    COLORREF leftColor;     // 왼쪽 테두리 색
    COLORREF rightColor;    // 오른쪽 테두리 색
    COLORREF topColor;      // 위쪽 테두리 색
    COLORREF bottomColor;   // 아래쪽 테두리 색
    
    // 대각선 (5.0.2.2 이상)
    BYTE diagonalType;      // 대각선 종류
    COLORREF diagonalColor; // 대각선 색
    
    // 배경
    FillInfo fillInfo;      // 배경 정보 (구조체)
}
```

## HWPTAG_CHAR_SHAPE (0x05)

글자 모양 정보입니다.

```
struct CharShape {
    WORD fontIds[7];        // 언어별 글꼴 ID
    BYTE fontRatios[7];     // 언어별 글자 크기 비율
    BYTE charSpacings[7];   // 언어별 자간
    BYTE relSizes[7];       // 언어별 상대 크기
    BYTE charOffsets[7];    // 언어별 글자 위치
    INT32 height;           // 기준 크기 (HWPUNIT)
    DWORD property;         // 속성
    BYTE shadowGaps[2];     // 그림자 간격
    COLORREF shadowColor;   // 그림자 색
    DWORD borderFillId;     // 글자 배경 ID
    COLORREF strikeColor;   // 취소선 색
}
```

### Property 필드 비트 구성
- bit 0: 기울임
- bit 1: 굵게
- bit 2-3: 밑줄 종류
- bit 4-7: 밑줄 모양
- bit 8-10: 외곽선 종류
- bit 11-12: 그림자 종류
- bit 13: 양각
- bit 14: 음각
- bit 15: 위 첨자
- bit 16: 아래 첨자
- bit 18-20: 취소선 종류
- bit 21-24: 강조점 종류
- bit 25: 글꼴에 어울리는 빈칸 사용
- bit 26-29: 취소선 모양
- bit 30: Kerning

## HWPTAG_TAB_DEF (0x06)

탭 정의 정보입니다.

```
struct TabDef {
    DWORD property;         // 속성
    DWORD count;            // 탭 개수
    
    struct TabItem {
        HWPUNIT position;   // 탭 위치
        BYTE type;          // 탭 종류
        BYTE fillType;      // 채움 종류
        WORD reserved;
    } tabs[count];
}
```

## HWPTAG_NUMBERING (0x07)

번호 매기기 정보입니다.

```
struct Numbering {
    WORD starts[7];         // 레벨별 시작 번호
    DWORD property[7];      // 레벨별 속성
    WORD charShapes[7];     // 레벨별 글자 모양 ID
}
```

## HWPTAG_BULLET (0x08)

글머리표 정보입니다.

```
struct Bullet {
    WORD charLength;        // 글머리 문자 길이
    WCHAR char[charLength]; // 글머리 문자
    BYTE property;          // 속성
    WORD checkBulletCharLength; // 체크 글머리 문자 길이
    WCHAR checkBulletChar[checkBulletCharLength];
}
```

## HWPTAG_PARA_SHAPE (0x09)

문단 모양 정보입니다.

```
struct ParaShape {
    DWORD property1;        // 속성 1
    INT32 leftMargin;       // 왼쪽 여백
    INT32 rightMargin;      // 오른쪽 여백
    INT32 indent;           // 들여쓰기
    INT32 prevSpacing;      // 문단 위 간격
    INT32 nextSpacing;      // 문단 아래 간격
    INT32 lineSpacing;      // 줄 간격
    WORD tabDefId;          // 탭 정의 ID
    WORD numberingBulletId; // 번호/글머리 ID
    WORD borderFillId;      // 테두리/배경 ID
    INT16 headingKind;      // 개요 종류
    BYTE headingLevel;      // 개요 수준
    DWORD property2;        // 속성 2
    DWORD property3;        // 속성 3
    DWORD lineSpacingValue; // 줄 간격 값
}
```

## HWPTAG_STYLE (0x0A)

스타일 정보입니다.

```
struct Style {
    WORD nameLength;        // 스타일 이름 길이
    WCHAR name[nameLength]; // 스타일 이름 (한글)
    WORD engNameLength;     // 영문 이름 길이
    WCHAR engName[engNameLength]; // 영문 이름
    BYTE property;          // 속성
    BYTE nextStyleId;       // 다음 스타일 ID
    INT16 languageId;       // 언어 ID
    WORD paraShapeId;       // 문단 모양 ID
    WORD charShapeId;       // 글자 모양 ID
    
    // 5.0.2.3 이상
    WORD lockForm;          // 양식 모드 잠금
}
```

## 주의사항

1. **ID 참조**: 각종 ID는 0부터 시작하는 인덱스
2. **버전 호환성**: 레코드 크기로 버전 구분
3. **필수 레코드**: DOCUMENT_PROPERTIES와 ID_MAPPINGS는 필수
4. **순서**: 레코드 순서가 중요함 (ID 매핑이 먼저 와야 함)