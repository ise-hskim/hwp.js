# 기본 자료형

## 정수형 자료형

### BYTE (INT8)
- **크기**: 1 바이트 (8비트)
- **범위**: 
  - 부호 없음: 0 ~ 255
  - 부호 있음: -128 ~ 127
- **용도**: 플래그, 작은 카운터, 문자 코드

### WORD (UINT16)
- **크기**: 2 바이트 (16비트)
- **범위**: 0 ~ 65,535
- **용도**: 문자 코드, 속성 값, 인덱스

### INT16
- **크기**: 2 바이트 (16비트)
- **범위**: -32,768 ~ 32,767
- **용도**: 좌표 값, 오프셋

### DWORD (UINT32)
- **크기**: 4 바이트 (32비트)
- **범위**: 0 ~ 4,294,967,295
- **용도**: 크기, 길이, 식별자

### INT32
- **크기**: 4 바이트 (32비트)
- **범위**: -2,147,483,648 ~ 2,147,483,647
- **용도**: 큰 범위의 좌표, 계산 값

## 문자형 자료형

### WCHAR (유니코드 문자)
- **크기**: 2 바이트 (16비트)
- **인코딩**: UTF-16 LE (Little Endian)
- **용도**: 유니코드 문자 저장
- **범위**: U+0000 ~ U+FFFF (BMP 영역)
- **서로게이트**: 서로게이트 쌍으로 유니코드 전체 표현 가능

### HCHAR (한글 문자 - 레거시)
- **크기**: 2 바이트 (16비트)
- **인코딩**: CP949 (KS C 5601-1992)
- **용도**: 레거시 한글 문서 지원
- **주의**: 새 문서에서는 WCHAR 사용 권장

### 문자열 처리

```c
// 길이 지정 문자열
typedef struct {
    WORD length;                // 문자 개수
    WCHAR text[length];         // 실제 문자열
} LPCWSTR;

// 언어별 문자열 (5.0.2.0+)
typedef struct {
    BYTE language;              // 언어 코드
    WORD length;                // 문자 개수
    WCHAR text[length];         // 언어별 문자열
} LANG_STRING;

// 다국어 문자열 배열
typedef struct {
    LANG_STRING hangul;         // 한글
    LANG_STRING english;        // 영어
    LANG_STRING hanja;          // 한자
    LANG_STRING japanese;       // 일본어
    LANG_STRING other;          // 기타
    LANG_STRING symbol;         // 기호
    LANG_STRING user;           // 사용자 정의
} MULTI_LANG_STRING;
```

## 한글 전용 자료형

### HWPUNIT (한글 단위 시스템)
- **크기**: 4 바이트 (32비트)
- **단위**: 1/7200 인치
- **용도**: 문서 내 모든 길이와 좌표
- **정밀도**: 소수점 없는 정수 단위로 고정밀 측정
- **변환 공식**: 
  - 1 point = 100 HWPUNIT
  - 1 inch = 7200 HWPUNIT
  - 1 mm = 283.465 HWPUNIT (정확히)
  - 1 cm = 2834.65 HWPUNIT
  - 1 pixel (96 DPI) = 75 HWPUNIT
  - 1 pixel (300 DPI) = 24 HWPUNIT

### HWPUNIT16 (단축형)
- **크기**: 2 바이트 (16비트)
- **단위**: 1/7200 인치
- **용도**: 작은 범위의 길이 값 (여백, 두께 등)
- **범위**: 0 ~ 65,535 HWPUNIT (약 9.1 인치)
- **제한**: 전체 페이지 크기는 다룰 수 없음

### SHWPUNIT (부호있는 단위)
- **크기**: 4 바이트 (32비트)
- **단위**: 1/7200 인치
- **용도**: 부호 있는 좌표 값 (상대적 위치)
- **범위**: 약 ±298 인치 (-2,147,483,648 ~ 2,147,483,647 HWPUNIT)
- **음수**: 왼쪽/위쪽 방향의 음수 오프셋

### 단위 변환 유틸리티

```c
// HWPUNIT 변환 함수
int pointToHwpUnit(double point) {
    return (int)(point * 100.0 + 0.5);  // 반올림
}

double hwpUnitToPoint(int hwpUnit) {
    return hwpUnit / 100.0;
}

int inchToHwpUnit(double inch) {
    return (int)(inch * 7200.0 + 0.5);
}

double hwpUnitToInch(int hwpUnit) {
    return hwpUnit / 7200.0;
}

int mmToHwpUnit(double mm) {
    return (int)(mm * 283.465 + 0.5);
}

double hwpUnitToMm(int hwpUnit) {
    return hwpUnit / 283.465;
}

// DPI만 좌표 변환
int pixelToHwpUnit(int pixel, int dpi) {
    return (int)(pixel * 7200.0 / dpi + 0.5);
}

int hwpUnitToPixel(int hwpUnit, int dpi) {
    return (int)(hwpUnit * dpi / 7200.0 + 0.5);
}
```

## 색상 자료형

### COLORREF (기본 색상)
- **크기**: 4 바이트 (32비트)
- **형식**: 0x00BBGGRR (BGR 순서, Windows 호환)
- **용도**: 색상 지정
- **예시**:
  - 빨강: 0x000000FF
  - 초록: 0x0000FF00
  - 파랑: 0x00FF0000
  - 흰색: 0x00FFFFFF
  - 검정: 0x00000000
  - 투명: 0xFF000000 (알파 채널 사용)

### 고급 색상 시스템 (5.0.3.0+)

```c
// ARGB 색상 (알파 채널 포함)
typedef struct {
    BYTE alpha;     // 투명도 (0=투명, 255=불투명)
    BYTE red;       // 빨강 성분
    BYTE green;     // 초록 성분
    BYTE blue;      // 파랑 성분
} ARGB_COLOR;

// HSV 색상 모델
typedef struct {
    WORD hue;           // 색상 (0-360도)
    BYTE saturation;    // 채도 (0-100%)
    BYTE value;         // 명도 (0-100%)
    BYTE alpha;         // 투명도
} HSV_COLOR;

// 그라디언트 색상 시스템
typedef struct {
    BYTE type;              // 그라디언트 타입
    BYTE angle;             // 방향 (0-360도)
    BYTE centerX;           // 중심 X (백분율)
    BYTE centerY;           // 중심 Y (백분율)
    BYTE stepCount;         // 단계 수
    ARGB_COLOR colors[8];   // 최대 8단계 색상
    BYTE positions[8];      // 각 단계의 위치 (백분율)
} GRADIENT_COLOR;

// 패턴 색상 (5.0.3.0+)
typedef struct {
    WORD patternType;       // 패턴 종류 (0-63)
    ARGB_COLOR foreground;  // 전경색
    ARGB_COLOR background;  // 배경색
    BYTE opacity;           // 전체 투명도
} PATTERN_COLOR;
```

### 색상 변환 유틸리티

```c
// COLORREF에서 RGB 추출
void colorrefToRGB(COLORREF color, BYTE* r, BYTE* g, BYTE* b) {
    *r = color & 0xFF;
    *g = (color >> 8) & 0xFF;
    *b = (color >> 16) & 0xFF;
}

// RGB에서 COLORREF 생성
COLORREF rgbToColorref(BYTE r, BYTE g, BYTE b) {
    return r | (g << 8) | (b << 16);
}

// HSV에서 RGB 변환
void hsvToRGB(HSV_COLOR hsv, BYTE* r, BYTE* g, BYTE* b) {
    // HSV 색상 모델 변환 알고리즘
    // 상세 구현은 색상 이론 참조
}
```

## 사용 시 주의사항

1. **바이트 순서**: 모든 다중 바이트 자료형은 리틀 엔디안으로 저장
2. **정밀도**: HWPUNIT 계산 시 정밀도 손실 방지를 위해 정수 연산 사용
3. **문자열**: NULL 종료 문자 없이 길이 정보로 처리
4. **인코딩**: UTF-16 LE가 기본, CP949는 레거시 지원만
5. **오버플로**: 단위 변환 시 오버플로 검사 필수
6. **언어 코드**: 언어별 글꼴 선택 시 언어 코드 확인
7. **타이포그래피**: 한국어 특성 고려 필수
8. **고정밀 연산**: 부동소수점 대신 고정밀 사용 권장
9. **좌표 체계**: 상대/절대 좌표 체계 구분
10. **배열 인덱싱**: 0 기반 인덱싱 (문서에서 1 기반으로 표시되는 경우 주의)
11. **색상 공간**: sRGB 색상 공간 기본, 프린터 색상은 CMYK 대안
12. **메모리 정렬**: 구조체 멤버는 내연 정렬 규칙 따름 (패딩 없음)

## 특수 자료형

### BIT
- **크기**: 가변 (비트 단위)
- **용도**: 플래그 집합, 속성
- **표기**: `필드명:비트수` (예: `bold:1`)

## 고급 인코딩 지원

### 인코딩 체계 (5.0+)

```c
// 문자 인코딩 지원 체계
enum CharEncoding {
    ENCODING_CP949 = 0,     // 한국어 CP949 (레거시)
    ENCODING_UTF16LE = 1,   // Unicode UTF-16 Little Endian (기본)
    ENCODING_UTF8 = 2,      // Unicode UTF-8 (대체)
    ENCODING_ANSI = 3       // 시스템 기본 인코딩
};

// 언어별 글꼴 매핑 (5.0.2.0+)
enum LanguageType {
    LANG_HANGUL = 0,        // 한글 (원어민)
    LANG_LATIN = 1,         // 라틴 문자 (영어 등)
    LANG_HANJA = 2,         // 한자 (중국어)
    LANG_JAPANESE = 3,      // 일본어
    LANG_OTHER = 4,         // 기타 언어
    LANG_SYMBOL = 5,        // 기호
    LANG_USER = 6           // 사용자 정의
};
```

### 한국어 타이포그래피 엔진 (5.0.3.0+)

```c
struct KoreanTypography {
    WORD hangulWordBreak;      // 한글 단어 나눔 규칙
    WORD latinWordBreak;       // 라틴 단어 나눔 규칙
    WORD lineSpacingRule;      // 줄 간격 규칙
    WORD characterSpacing;     // 자간 조절
    WORD kerningMethod;        // 커닝 방식
    WORD baselineAlignment;    // 베이스라인 정렬
};
```

### 고정밀 숫자 표현 (FIXED)

```c
typedef struct {
    INT32 value;            // 실제 값 * 65536
} FIXED;

// FIXED 값 변환
double fixedToDouble(FIXED fixed) {
    return fixed.value / 65536.0;
}

FIXED doubleToFixed(double value) {
    FIXED result;
    result.value = (INT32)(value * 65536.0 + 0.5);
    return result;
}
```

## 사용 시 주의사항

1. **바이트 순서**: 모든 다중 바이트 자료형은 리틀 엔디안으로 저장
2. **정밀도**: HWPUNIT 계산 시 정밀도 손실 방지를 위해 정수 연산 사용
3. **문자열**: NULL 종료 문자 없이 길이 정보로 처리
4. **인코딩**: UTF-16 LE가 기본, CP949는 레거시 지원만
5. **오버플로**: 단위 변환 시 오버플로 검사 필수
6. **언어 코드**: 언어별 글꼴 선택 시 언어 코드 확인
7. **타이포그래피**: 한국어 특성 고려 필수
8. **고정밀 연산**: 부동소수점 대신 고정밀 사용 권장
9. **좌표 체계**: 상대/절대 좌표 체계 구분
10. **배열 인덱싱**: 0 기반 인덱싱 (문서에서 1 기반으로 표시되는 경우 주의)