# 배열

한글 문서 파일에서 사용하는 배열 자료형에 대한 설명입니다.

## 배열의 종류

### 1. 고정 크기 배열

고정 크기 배열은 미리 정해진 크기를 가지며, 다음과 같이 표기합니다:

```
자료형[크기]
```

**예시:**
- `BYTE[10]`: 10개의 바이트 배열
- `WCHAR[256]`: 256개의 유니코드 문자 배열
- `DWORD[4]`: 4개의 DWORD 배열

### 2. 가변 크기 배열

가변 크기 배열은 실행 시점에 크기가 결정되며, 다음과 같이 표기합니다:

```
자료형[n]
```

여기서 `n`은 별도로 저장된 크기 정보를 나타냅니다.

**구조:**
```
struct VariableArray {
    WORD size;      // 배열의 크기
    자료형 data[size];  // 실제 데이터
}
```

### 3. NULL 종료 배열

일부 배열은 특정 값(주로 0)으로 종료됩니다:

```
자료형[?]
```

## 배열 저장 방식

### 연속 저장
- 배열의 모든 요소는 메모리에 연속적으로 저장됩니다.
- 요소 간 패딩이 없습니다.

### 크기 정보
가변 크기 배열의 경우 크기 정보가 다음 위치에 저장될 수 있습니다:
1. 배열 직전에 저장
2. 상위 구조체의 별도 필드에 저장
3. 레코드 헤더에 저장

## 문자열 배열

### 유니코드 문자열
```
WCHAR[n]
```
- UTF-16 LE 인코딩 사용
- NULL 종료 문자 포함 여부는 문맥에 따라 다름

### 멀티바이트 문자열
```
BYTE[n]
```
- 주로 CP949 인코딩 사용
- 파일 경로 등에 사용

## 배열 읽기 예시

### 고정 크기 배열 읽기
```c
BYTE reserved[10];
fread(reserved, sizeof(BYTE), 10, file);
```

### 가변 크기 배열 읽기
```c
WORD count;
fread(&count, sizeof(WORD), 1, file);

WCHAR* text = malloc(count * sizeof(WCHAR));
fread(text, sizeof(WCHAR), count, file);
```

## 주의사항

1. **바이트 순서**: 모든 배열 요소는 리틀 엔디안으로 저장됩니다.
2. **정렬**: 배열 내부에는 정렬을 위한 패딩이 없습니다.
3. **크기 검증**: 가변 크기 배열을 읽을 때는 반드시 크기를 먼저 확인해야 합니다.
4. **메모리 할당**: 큰 배열을 읽을 때는 메모리 부족에 주의해야 합니다.